<div class="vault-list">
  <div class="vault-list__header">
    <h2>Mis Vaults</h2>
    
    <button 
      mat-raised-button 
      color="primary"
      *ngIf="!(isConnected$ | async)"
      (click)="connectWallet()"
    >
      Conectar Wallet
    </button>
  </div>

  <div class="vault-list__loading" *ngIf="(isLoading$ | async)">
    <mat-spinner diameter="30"></mat-spinner>
    <span>Cargando vaults...</span>
  </div>

  <div class="vault-list__error" *ngIf="(error$ | async) as error">
    {{ error }}
  </div>

  <div class="vault-list__content">
    <div class="vault-list__empty" *ngIf="(vaults$ | async)?.length === 0 && (isConnected$ | async)">
      <p>No tienes vaults creados a√∫n</p>
      <button mat-flat-button color="accent" routerLink="/vault/create">
        Crear nuevo vault
      </button>
    </div>

    <div class="vault-list__grid">
      <mat-card 
        class="vault-card"
        [class.vault-card--selected]="(currentVault$ | async)?.address === vault.address"
        *ngFor="let vault of (vaults$ | async)"
        (click)="selectVault(vault)"
      >
        <mat-card-header>
          <mat-card-title>{{ vault.metadata.name }}</mat-card-title>
          <mat-card-subtitle>
            {{ getCategoryLabel(vault.metadata.category) }}
          </mat-card-subtitle>
        </mat-card-header>

        <mat-card-content>
          <div class="vault-card__balance">
            <strong>Balance:</strong> {{ formatBalance(vault.balance) }} ETH
          </div>
          
          <div class="vault-card__type">
            <mat-icon>
              {{ vault.type === 'SingleOwner' ? 'person' : 
                 vault.type === 'MultiSig' ? 'group' :
                 vault.type === 'Timelock' ? 'schedule' : 'attach_money' }}
            </mat-icon>
            {{ vault.type }}
          </div>

          <div class="vault-card__target" *ngIf="vault.metadata.target">
            <strong>Meta:</strong> {{ vault.metadata.target }} ETH
          </div>
        </mat-card-content>

        <mat-card-actions class="vault-card__actions">
            <button mat-button (click)="openDepositDialog(vault)">Depositar</button>
            <button mat-button [disabled]="!isVaultOwner(vault)" (click)="openWithdrawDialog(vault)">Retirar</button>

          <button mat-button color="accent" (click)="$event.stopPropagation()">
            Editar
          </button>
        </mat-card-actions>
      </mat-card>
    </div>
  </div>
</div>